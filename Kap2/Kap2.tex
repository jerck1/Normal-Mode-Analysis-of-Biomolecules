\chapter{Modelos Te\'{o}ricos}
\section{Relevancia}
Es importante estudiar los movimientos de una biomol\'{e}cula ya que como es se\~{n}alado en \cite{Lezon2009ElasticViruses} y en  \cite{Rader2006TheApplications}, la din\'{a}mica de la mol\'{e}cula vincula la estructura con la funci\'{o}n de la biomol\'{e}cula. La funci\'{o}n es el papel que desempe\~{n}a la biomol\'{e}cula y que est\'{a} intimamente relacionado con las interacciones de la biomol\'{e}cula a un ligando. La estructura de una biomol\'{e}cula tiene tiene 4 niveles de organizaci\'{o}n, denominadas \textit{estructuras primaria, secundaria, terciaria y cuaternaria}.\\

Por ejemplo, en una prote\'{i}na la estructura primaria es la secuencia u  orden de los mon\'{o}meros (amino\'{a}cidos) que la constituyen. La estructura secundaria est\'{a} determinada por los puentes de hidr\'{o}geno existentes entre los grupos amino y carboxilo de dos amino\'{a}cidos diferentes; predice la estructura tridimensional en forma local. Mientras que la estructura terciaria la da el arreglo tridimensional de cada uno de sus \'{a}tomos, espec\'{i}ficamente se determina con las coordenadas de cada uno de los \'{a}tomos. La estructura cuaternaria es el arreglo de unidades proteicas o cadenas pept\'{i}dicas formando lo que se conoce como complejo multiproteico.\\

Algunas prote\'{i}nas est\'{a}n en la clase de prote\'{i}nas de transporte que se encuentran en la membrana celular, la funci\'{o}n que cumplen es act\'{u}ar como mediadoras para el transporte de iones y sustratos, convirti\'{e}ndose este en un paso previo al metabolismo y la energ\'{e}tica celular al interior de la c\'{e}lula.\\
\section{Din\'{a}mica de una Biomol\'{e}cula}

La din\'{a}mica de una biomol\'{e}cula se determina por las ecuaciones de movimiento para cada uno de los \'{a}tomos que la constituyen. Usualmente en una biomol\'{e}cula el n\'{u}mero de mon\'{o}meros es mayor a 20, que al multiplicarlo por el n\'{u}mero de \'{a}tomos en cada mon\'{o}mero incrementa considerablemente el n\'{u}mero de ecuaciones de movimiento a resolver, de ah\'{i} que sea necesario realizar \textit{din\'{a}mica molecular} (Molecular Dynamics que por sus siglas en ingl\'{e}s es MD) la cual estudia mediante simulaciones computacionales el movimiento de los \'{a}tomos, de acuerdo a las interacciones que presenten.\\

Las ecuaciones de movimiento se pueden conocer a partir de los formalismos lagrangiano o hamiltoniano \cite{Goldstein2001ClassicalMechanics}, en los cuales es necesario conocer los potenciales con los que interact\'{u}an los \'{a}tomos. Las soluciones a las ecuaciones de movimiento se encuentran mediante los m\'{e}todos de la din\'{a}mica molecular o los an\'{a}lisis de modos normales (Normal Mode Analysis que por sus siglas en ingl\'{e}s es NMA) en los cuales se escogen los modelos de potencial.\\

Los diversos modelos de potencial pueden ser tomados seg\'{u}n la naturaleza del pol\'{i}mero a analizar, ver \cite{Lezon2009ElasticViruses}. Sin embargo, al escoger el potencial  para hacer un an\'{a}lisis \textit{in silico} de la din\'{a}mica de una biomol\'{e}cula, debe tenerse en cuenta el costo computacional requerido, esto es, el tiempo de simulaci\'{o}n de la mol\'{e}cula y la exactitud requerida en el movimiento de cada uno de los constituyentes de la mol\'{e}cula.\\

De acuerdo a los par\'{a}metros de costo y tiempo, las simulaciones de biomol\'{e}culas se pueden hacer analizando los \textit{movimientos locales} y los \textit{movimientos globales}.

\section{Movimientos Globales}

Son aqu\'{e}llas simulaciones en las que se desean conocer los \textit{cambios globales} o el aspecto general que excibe el movimiento de una biomol\'{e}cula haciendo simplificaciones, ya sea en los potenciales presentes o en el n\'{u}mero de \'{a}tomos interconectados. Este tipo de simulaciones pueden ser realizadas a un orden de magnitud de los microsegundos, lo cual facilita su uso en computadores personales, al respecto ver \cite{Gur2013GlobalPredictions.}.\\

Un conjunto de modelos que permite calcular los movimientos globales de una mol\'{e}cula son los \textit{Modelos de Redes El\'{a}sticas} (Elastic Network Models o ENM por sus siglas en ingl\'{e}s).
 Otros modelos que describen los movimientos globales son los an\'{a}lisis por componentes principales (Principal Component Analysis o PCA por sus siglas en ingl\'{e}s) y el an\'{a}lisis por modos normales est\'{a}ndar (Normal Mode Analysis o NMA por sus siglas en ingl\'{e}s).
 
\subsection{Modelos de Redes El\'{a}sticas (ENM)}
Los ENM, como la palabra \textit{el\'{a}stico} lo indica, se basan en una simplificaci\'{o}n de la energ\'{i}a potencial a una energ\'{i}a potencial el\'{a}stica, es decir de tipo Hooke.Un requisito para que sea posible hacer dicha simplificaci\'{o}n, es la de minimizar la energ\'{i}a potencial. \\

Al simplificar el potencial, la biomol\'{e}cula original se convierte en una red cuyos nodos est\'{a}n sometidos al potencial el\'{a}stico, ver figura \ref{fig:pan}. Los nodos se consideran como bloques constituyentes de la biomol\'{e}cula y no siempre los nodos coincidir\'{a}n con cada uno de los \'{a}tomos en la biomol\'{e}cula. La elecci\'{o}n del bloque constituyente depende de la compatibilidad del modelo con los datos experimentales, que se encuentra reflejado en la estabilidad de los enlaces con respecto a su posici\'{o}n de equilibrio, de tal manera que cada bloque constituyente pueda considerarse como una part\'{i}cula puntual o incluso como un cuerpo r\'{i}gido. \\
\begin{figure}
\centering%
\includegraphics[scale=0.3]{Kap2/dibujo.pdf}%
\caption{ (a) Vista exterior de un c\'{a}pside v\'{i}rico HK97 coloreado por cada cadena, todas las prote\'{i}nas son id\'{e}nticas. (b) Vista del arreglo prote\'{i}nico en una cara del c\'{a}pside. (c) Vista de la estructura secundaria de las prote\'{i}nas (d) Esquema de cada prote\'{i}na mostrando cada uno de sus \'{a}tomos, las aristas de cada cara son carbonos $\alpha$ unidos por lados (ligaduras el\'{a}sticas). Tomado de \cite{Lezon2009ElasticViruses}.} \label{fig:pan}
\end{figure}
\subsubsection{Descripci\'{o}n Mec\'{a}nica del Modelo}

Consid\'{e}rese una biomol\'{e}cula con $N$ part\'{i}culas constituyentes, el tipo de constituyente depende del modelo apropiado para la biomol\'{e}cula, por ejemplo en las prote\'{i}nas como la BPTI, ver \cite{Gur2013GlobalPredictions.}, los constituyentes son los carbonos $\alpha$ de los amino\'{a}cidos.\\

La energ\'{i}a potencial $V$ que representa las interacciones entre los constituyentes de la biomol\'{e}cula, se puede expresar alrededor de las posiciones de equilibrio $\mathbf{q_0}=\mathbf{0}$ tal como describe la teor\'{i}a de peque\~{n}as oscilaciones, ver \cite{Goldstein2001ClassicalMechanics}:
\begin{equation}
V(q)=V(\mathbf{0})+\sum_{i=1}^n\frac{\partial V}{\partial q_i}q_i+\sum_{ij}^{n}\frac{\partial^2 V }{\partial q_i\partial q_j}q_i q_j+...
\end{equation}\label{eq:1}
Donde $q_i$ son los desplazamientos con respecto a las posiciones de equilibrio, $n$ es el n\'{u}mero de posibles desplazamientos en la biomol\'{e}cula. $V(\mathbf{0})$ es el potencial en equilibrio que por conveniencia puede ser calibrado a cero: $V(\mathbf{0})=0$. \\


El sistema se encuentra alrededor del equilibrio cuando las fuerzas generalizadas se anulan, esto es:
\begin{equation}
\frac{\partial V}{\partial q_i}=0
\end{equation}\label{eq:2}
En este tipo de casos como la energ\'{i}a se minimiza, se dice que hay un equilibrio estable. Para entender esto, sup\'{o}gase que la energ\'{i}a total, que en este caso es $E=T+V$ corresponde al punto de equilibrio donde los nodos no se mueven, es decir, $E=V_{min}$ (l\'{i}nea punteada de la figura \ref{fig:pot}). Ahora suponga que hay una incremento de la energ\'{i}a total en una cantidad $\Delta E$, este incremento generar\'{a} un aumento en la energ\'{i}a potencial, l\'{i}nea continua.  Si el sistema se desv\'{i}a de la posici\'{o}n de equilibrio, por conservaci\'{o}n de la energ\'{i}a y como $E=T+V$, la energ\'{i}a cin\'{e}tica disminuye. En un equilibrio inestable la energ\'{i}a cin\'{e}tica aumenta, alejando al sistema del equilibrio. \cite{Goldstein2001ClassicalMechanics} \\


\begin{figure}
\centering%
\input{Kap2/Potencial.tex}%
\put(-870,330){$E$}
\put(-1000,480){$E+\Delta E$}
\put(-400,390){$T$}
\put(-405,345){\vector(0,1){130}}
\put(-280,410){$T$}
\put(-300,375){\vector(0,1){100}}
\caption{Potencial en funci\'{o}n de la posici\'{o}n y energ\'{i}a total $E$} \label{fig:pot}
\end{figure}

Considerando la condici\'{o}n de equilibrio \eqref{eq:2} y despreciando desplazamientos de orden superior se tiene que:
\begin{equation}
V(\mathbf{q})=\sum_{i,j=1}^{n}\frac{\partial^2 V }{\partial q_i\partial q_j}q_i q_j
\end{equation}\label{eq:3}

Donde se identifican las constantes el\'{a}sticas como:
\begin{equation}
H_{ij}=\frac{\partial^2 V }{\partial q_i\partial q_j}
\end{equation}\label{eq:4}

En t\'{e}rminos matriciales el potencial se puede escribir como:
\begin{equation}
V(\mathbf{q})=\mathbf{q}^t\mathbf{H}\mathbf{q}
\end{equation}\label{eq:5}
En la ecuaci\'{o}n \eqref{eq:5} $\mathbf{q}$ es el vector columna formado por los desplazamientos de las posiciones de equilibrio para cada constituyente, i. e., $\mathbf{q}^t=(q_1,q_2,...q_n)$. Por otro lado la matriz de constantes el\'{a}sticas $\mathbf{H}$, es una matriz sim\'{e}trica debido a que la fuerza generalizada se considera conservativa, lo cual permite intercambiar el orden de las derivadas parciales.\\

Para las peque\~{n}as oscilaciones, no existen ligaduras dependientes expl\'{i}citamente de el tiempo (holon\'{o}micas) luego, la eneg\'{i}a cin\'{e}tica de los constituyentes s\'{o}lo depender\'{a} de los cuadrados de las velocidades generalizadas:
\begin{equation}
T=\frac{1}{2}\mathbf{q}^t\mathbf{M}\mathbf{q}
\end{equation}\label{eq:6}
Donde $\mathbf{M}$ es la masa generalizada, la cual se expresa en t\'{e}rminos de los factores de escala entre sistemas coordenados:
\begin{equation}
M_{jk}=\sum_{i=1}^{N} m_{i}\frac{\partial \mathbf{r_{i}} }{\partial q_j}\cdot\frac{\partial \mathbf{r_{i}} }{\partial q_k}
\end{equation}\label{eq:7}
La forma en que se escribir\'{a}n los elementos de la masa del sistema depende de la transformaci\'{o}n aplicada. Por ejemplo, en una dimensi\'{o}n las componentes de $\mathbf{q}$ se definen como:
\begin{equation}
q_i=x_i-x_{i0}
\end{equation}\label{eq:8}
En \eqref{eq:8} $x_i$ es la posici\'{o}n variable de la part\'{i}cula $i$ con respecto a un sistema fijo y $x_{i0}$ su posici\'{o}n de equilibrio. Para este caso particular \eqref{eq:7} se convierte en:
\begin{eqnarray}
M_{jk}&=&\sum_{i=1}^{N} m_{i} \delta_{ij}\delta_{ik}\nonumber \\
M_{jk}&=&m_{j} \delta_{jk}
\end{eqnarray}\label{eq:9}
La equaci\'{o}n \eqref{eq:9} dice que la matriz $\mathbf{M}$ es una matriz diagonal cuyas componentes son las masas del sistema.\\
En tres dimensiones, como es nuestro caso real, la transformaci\'{o}n depender\'{a} del modelo escogido. Exceptuando el modelo de redes gaussianas (Gaussian Network Model que por sus siglas en ingl\'{e}s es GNM) la transformaci\'{o}n de coordenadas va de $\mathbf{r}_{i}$ posiciones con $i=1,2,...,N$ ($3N$ coordenadas) a $q_j$ coordenadas $j=1,2,..,3N$:
\begin{equation*}
\mathbf{r}_{i}\longrightarrow q_{j}
\end{equation*}
Con
\begin{equation*}
i=1,2,...,N\mbox{  }j=1,2,..,3N
\end{equation*}
Por cada componente en cartesianas:
\begin{eqnarray}
\begin{array}{cccccc}
q_1=x_1-x_{10}&q_4=x_2-x_{20}&\cdots &q_{3i-2}=x_i-x_{i0}&\cdots &q_{3N-2}=x_N-x_{N0} \\
q_2=y_1-y_{10}&q_5=y_2-y_{20}&\cdots &q_{3i-1}=y_i-y_{i0}&\cdots &q_{3N-1}=y_N-y_{N0}\\
q_3=z_1-z_{10}&q_6=z_2-z_{20}&\cdots &q_{3i}=z_i-z_{i0}&\cdots &q_{3N}=z_N-z_{N0}\\
\end{array}
\end{eqnarray}\label{eq:10}
Para esta transformaci\'{o}n, \eqref{eq:7} se convierte en:
\begin{eqnarray}
M_{jk}&=&\sum_{i=1}^{N} m_{i}\left( \delta_{i,3j-2}\delta_{jk}+\delta_{i,3j-1}\delta_{jk}+  \delta_{i,3j}\delta_{jk}\right)\nonumber \\
M_{jk}&=&m_{3j-2}\delta_{jk}+m_{3j-1}\delta_{jk}+m_{3j}\delta_{jk} \nonumber \\
M_{jk}&=&\left( m_{3j-2}+m_{3j-1}+m_{3j} \right) \delta_{jk}
\end{eqnarray}\label{eq:11}
En \eqref{eq:11} debe resaltarse que para $j=k=3N$, el elemento de matriz $M_{3N,3N}$ requiere las masas $m_{3(3N)-2}=m_{9N-2}$, $m_{3(3N)-1}=m_{9N-1}$ y $m_{3(3N)}=m_{9N}$, sin embargo ! no hay $9N$ masas!, el n\'{u}mero de masas es el mismo n\'{u}mero de nodos: $N$, entonces, para poder calcular la matriz $\mathbf{M}$ es necesario definir lo siguiente:
\begin{equation}
m_{N+1},m_{N+2},...,m_{3N}=0
\end{equation}\label{eq:12}
Como a partir de $N+1$ las masas son nulas, la matriz de masa (que es diagonal) tiene elementos nulos si  
\begin{eqnarray*}
3j-2=N+1\\
j=\frac{N+3}{3} \\
\end{eqnarray*}
Como no siempre $N$ es m\'{u}ltiplo de 3, se escoge el entero menor que este m\'{a}s cerca al valor:
\begin{equation}
j=\left \lfloor\frac{N+3}{3}\right \rfloor
\end{equation}\label{eq:13}
\paragraph{Ecuaci\'{o}n de Movimiento}
El sistema satisface la ecuaci\'{o}n de un oscilador arm\'{o}nico, tal como es descrito en \cite{Goldstein2001ClassicalMechanics}:
\begin{equation}
\mathbf{q}\mathbf{M}+\mathbf{q}\mathbf{H}=\mathbf{0}
\end{equation}\label{eq:14}
\subsubsection{Ensamble Estad\'{i}stico}
\subsubsection{Modelo de Redes Gaussianas (GNM)}
\subsubsection{Modelos de Redes Anisotr\'{o}picas (ANM)}
\subsection{An\'{a}lisis de Modos Normales Est\'{a}ndar (NMA)}
Describe un sistema oscilatorio en el que todos los constituyentes del sistema oscilan sinusoidalmente y con la misma frecuencia.
\subsection{An\'{a}lisis por Componentes Principales (PCA)}
\section{Movimientos Locales}
Hace referencia a las simulaciones en las que se incluyen todos los \'{a}tomos junto con las interacciones presentes, es decir, en las que se analizan los \textit{cambios locales}. Estas se pueden simular a un orden de magnitud de los nanosegundos en una m\'{a}quina usual, al respecto ver \cite{Gur2013GlobalPredictions.}.

Como caso particular se pueden tomar los potenciales usados en \cite{Amber2016AmberManual}, que siguen el modelo de Amber. El modelo de Amber tiene en cuenta las contribuciones debidas a:
 \begin{itemize}
\item Interacciones intermoleculares: Son las producidas por los enlaces covalentes entre grupos de \'{a}tomos, las de valencia y las torsiones.
\item Interacciones entre pares: Lennard Jones, electrost\'{a}tico.
\end{itemize}

\subsubsection{An\'{a}lisis por Componentes Principales}

\begin{itemize}
\item 
\end{itemize}
